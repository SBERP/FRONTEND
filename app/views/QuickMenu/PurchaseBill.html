<script type="text/javascript" src="//asprise.azureedge.net/scannerjs/scanner.js"></script>
<style>
.hackyhack{position:relative}.hackyhack .dropdown-menu{left:auto!important;right:0}h4 .control-label{font-size:13px!important}.contentOfForm{padding-left:11px;padding-right:7px}.goButton{padding:6px 16px}.imageAncher{position:relative;vertical-align:middle;display:inline-block}.myCrossDesign{position:absolute;top:0;right:0;height:20px;width:20px;color:#eb615f;font-size:20px}.myCrossDesign:hover{color:red}.documentRight{display:block;position:absolute;top:10%;right:60%;font-size:40px;color:#88bf57}.documentRight:hover{color:green}.documentCross{display:block;position:absolute;font-size:40px;color:#eb615f;top:10%;right:20%}.documentCross:hover{color:red}.input-file{position:relative;margin:60px 60px 0}.input-file .input-group-addon{border:0;padding:0}.input-file .input-group-addon .btn{border-radius:0 4px 4px 0}.input-file .input-group-addon input{cursor:pointer;position:absolute;width:72px;z-index:2;top:0;right:0;filter:alpha(opacity=0);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";opacity:0;background-color:transparent;color:transparent}
.productColorSizeDesign{
	width:50%;
	padding-left: 6px;
	padding-right: 6px;
	float:left;
}
.productColorSizeWidth{
	width:100%;
}
.productColorSizeVarDesign{
	width:33.33%;
	padding-left: 6px;
	padding-right: 6px;
	float:left;
}
.tableTopCss{
	border-top: #b8c1cf 1px solid !important;
}
.itemize-expand-tree,.itemize-expand-tree ul{
    margin: 0;
    padding: 0;
    list-style: none;
}
.itemize-expand-tree ul{
	margin-left: 1em;
    position: relative;
}
.itemize-expand-tree ul:before{
	content: "";
    display: block;
    width: 0;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    border-left: 1px solid;
}
.itemize-expand-tree li{
	margin: 0;
    padding: 0 1em;
    line-height: 2em;
    color: #369;
    font-weight: 700;
    position: relative;
}
.itemize-expand-tree ul li:before{
	content: "";
    display: block;
    width: 10px;
    height: 0;
    border-top: 1px solid;
    margin-top: -1px;
    position: absolute;
    top: 1em;
    left: 0;
}
.itemize-expand-tree ul li:last-child:before{
	background: #fff;
    height: auto;
    top: 1em;
    bottom: 0;
}
.myTable td{
	vertical-align: top !important;
}
</style>
<!-- START panel-->
<div class="container-fluid"   >
	<toaster-container toaster-options="{'position-class': 'toast-top-right', 'close-button':true,'animation-class': 'bounceIn'}"></toaster-container>
	<form  action="#" name="formBill" class="form-validate form-horizontal" autocomplete="off" novalidate>
	<div class="panel panel-default">
		<h4 class="panel-heading col-sm-12" style="padding:5px 1px;" >	
			<div style="padding: 0 5px 0 5px;"  ng-class="col-sm-5" >

				<label  class="control-label" style="font-size: 19px !important;float: left;text-align: left;padding-top: 3px;padding-left: 0px;padding-right: 0px;">
					<span ng-if="purchaseType == 'purchaseBill'">Purchase Bills </span>
					<span ng-if="purchaseType == 'purchaseOrder'">Purchase Order </span>
					<span style="font-size:15px">[ {{purchaseBill.billNumber}} ]</span>
				</label>
			 </div>
			 <div style="padding: 0 5px 0 5px;"  ng-class="col-sm-2" >
			 	<label  class="control-label" style="font-size:18px !important;text-align: right;padding-top: 3px;padding-left: 1px;padding-right: 0px;margin-left:21%;">
				 	<button type="button" class="btn btn-default btn-md" data-ng-class="app.theme.brand"  >{{displayDefaultCompanyName}} ({{getCurrentFinancialYear()}})</button>
				</label>
			 </div>
		</h4>
		 <h4 class="panel-heading col-sm-12 pb-sm ph0 pl0 pt-sm" >
			<!-- <div class="col-sm-3">
				<label  class="control-label" style="font-size: 19px !important;float: left;text-align: left;padding-top: 3px;padding-left: 0px;padding-right: 0px;">Purchase Bill <span style="font-size:15px">[ {{purchaseBill.billNumber}} ]</span></label>
			</div> -->
			<div class="col-sm-2" >
				<div class="input-group m-b">
					<input  type="text" ng-model="purchaseBill.searchInvoiceNumber" placeholder="Search" class="form-control input-sm" tooltip="Search By Bill#/VendorName" tooltip-trigger="focus" tooltip-placement="top" ng-keyup="$event.keyCode == 13 ? goInvoiceNumber() : null" />
					<span class="input-group-btn">
					<button type="button" class="btn btn-sm" data-ng-class="app.theme.brand"  ng-click="goInvoiceNumber()" ><em class="fa fa-search" ></em></span>
					</span>
				</div>
			</div>
			<div class="col-sm-4">
				<label  class="col-sm-3 control-label"> *Company </label>
				<div class="col-sm-9 contentOfForm" >
					<select chosen="" data-ng-model="purchaseBill.companyDropDown" name="companyDropDown" data-ng-options="s.companyName for s in form.companyDrop track by s.companyId" ng-change="changeCompany(purchaseBill.companyDropDown)" ng-disabled="form.disableCompany" class="form-control input-sm chosen-select" ng-required="true"></select>
				</div>
			</div>
			<div class="col-sm-3">
				<label  class="col-sm-2 control-label"> *Date </label>
				<div class="col-sm-8">
					 <div class="input-group hackyhack" >
						<input type="text" datepicker-popup="{{form.format}}"  data-ng-model="form.dt1" is-open="form.openedStart" min-date="false" max-date="false" datepicker-options="form.dateOptions" date-disabled="form.disabled(form.date, form.mode)" ng-change="changeBillDate('entryDate')" close-text="Close" class="form-control input-sm" id="entryDate" ng-required="true" readonly/>
						<span class="input-group-btn">
						   <button type="button" data-ng-click="form.openStart($event)" id="datepickerButton"  class="btn btn-sm" data-ng-class="app.theme.brand">
							  <em class="fa fa-calendar"></em>
						   </button>
						</span>
					 </div>
				</div>
				<div class="col-sm-2">
					<button type="button" class="btn btn-sm pb-sm pt-sm"  data-ng-class="app.theme.brand"   ui-sref="app.AccViewWholeSales"  ><i class="fa fa-search"></i></button>
				</div>
			</div>
		 </h4>
		<div class="panel-body" style="padding:0px">
			<div class="col-sm-12">
				<div class="col-sm-3">
					<fieldset class="my-fieldset-paddingBottom my-fieldset-marginBottom">
					   <div class="form-group">
						  <label  class="col-sm-3 control-label">*Bill#</label>
						  <div class="col-sm-9">
							 <input ng-model="purchaseBill.billNumber" ng-change="changeInBill('billNumber',purchaseBill.billNumber)"  type="text" placeholder="Bill Number" class="form-control input-sm" dir="ltr" name="contactNo" id="contactNoSelect"  auto-focus="true" ng-required="true"  style="font-size:15px;" />
							 
							<span ng-messages="formBill.contactNo.$error" ng-if="formBill.contactNo.$dirty || formBill.contactNo.$touched" role="alert">
								<span ng-messages-include="errorRequired"></span>
								<span ng-messages-include="errorPatternNumberContact"></span>
								<span ng-messages-include="errorLonglength"></span>
								<span ng-messages-include="errorShortlength"></span>
							</span>
						  </div>
					   </div>
					</fieldset >
				</div>
				<div class="col-sm-5">
					<fieldset class="my-fieldset-paddingBottom my-fieldset-marginBottom">
						 <div class="form-group">
							<label  class="col-sm-3 control-label">*Vendor Name</label>
							<div class="col-sm-9">
								<div class="input-group">
									<input  typeahead="s.ledgerName for s in form.clientNameDropCr | filter:$viewValue | orderBy:'ledgerName' | limitTo:10" ng-model="purchaseBill.ledgerName" typeahead-on-select="setVenderId('vendorId',$item);changeProductTable();" typeahead-editable="false" autocomplete="off"  type="text" placeholder="Vendor Name" class="form-control input-sm" dir="ltr" name="clientName" ng-required="true" />
									<span class="input-group-btn">
										<button type="button" class="btn btn-default btn-sm" ng-if="purchaseBill.ledgerEditableData" ng-click="editLedgerWithRedirect()"><i class="fa fa-edit" style="font-size:15px;color:#17A1E5;"></i></button>
										<button type="button" class="btn btn-default btn-sm" data-ng-click="openLedger('lg')"><i class="fa fa-plus" style="color:#17A1E5;"></i></button>
									</span>
								</div>
								<span ng-messages="formBill.clientName.$error" ng-if="formBill.clientName.$dirty || formBill.clientName.$touched" role="alert">
									<span ng-messages-include="errorRequired"></span>
									<span ng-messages-include="errorPatternAlpha"></span>
									<span ng-messages-include="errorLonglength"></span>
									<span ng-messages-include="errorShortlength"></span>
								</span>
							</div>
						</div>
					</fieldset >
				</div>
			</div>
      </div>
     <!-- <div class="table-responsive"> -->
     	<div>
		<table  class="table table-bordered table-striped tableTopCss" >
			<thead>
				<tr>
					<th class="header my-table-paddingTopBottom" style="width:1%;padding-top:5px !important;padding-bottom:5px !important;">#</th>
					<th class="header my-table-paddingTopBottom" style="width:30%;padding-top:5px !important;padding-bottom:5px !important;min-width:150px;" >Name of Item</th>
					<th class="header my-table-paddingTopBottom" style="width:3%;padding-top:5px !important;padding-bottom:5px !important;">HSN</th>
					<th ng-if="divAdvanceMou" class="header" style="width:6%;padding-top:5px !important;padding-bottom:5px !important;">	Unit
					</th>
					<th ng-if="enableDisableLWHSetting" class="header" style="text-align:center;width:11%;padding-top:5px !important;padding-bottom:5px !important;">L | W | H</th>
					<th ng-if="divTag" class="header my-table-paddingTopBottom" style="width:11%;padding-top:5px !important;padding-bottom:5px !important;text-align:center">
						<span  ng-if="enableDisableColor">Color  </span> 
						<span ng-if="(enableDisableColor && enableDisableSize)"> | </span>
						<span ng-if="enableDisableSize">Size</span>
						<span ng-if="(enableDisableColor && enableDisableVariant) || (enableDisableSize && enableDisableVariant) "> | </span>
						<span ng-if="enableDisableVariant">Variant</span>
					</th>
					<th ng-if="enableDisableFrameNo" class="header my-table-paddingTopBottom" style="width:8%;padding-top:5px !important;padding-bottom:5px !important;">Frame#</th>
					<th class="header my-table-paddingTopBottom" style="width:4%;padding-top:5px !important;padding-bottom:5px !important;" >Qty.</th>
					<th class="header my-table-paddingTopBottom" style="width:10%;padding-top:5px !important;padding-bottom:5px !important;" >Rate</th>
					<th class="header my-table-paddingTopBottom" style="width:9%;padding-top:5px !important;padding-bottom:5px !important;">Discount</th>
					<th class="header my-table-paddingTopBottom" style="width:5%;padding-top:5px !important;padding-bottom:5px !important;" >CGST</th>
					<th class="header my-table-paddingTopBottom" style="width:5%;padding-top:5px !important;padding-bottom:5px !important;" >SGST</th>
					<th class="header my-table-paddingTopBottom" style="width:5%;padding-top:5px !important;padding-bottom:5px !important;" >IGST</th>
					<th class="header my-table-paddingTopBottom" style="width:9%;padding-top:5px !important;padding-bottom:5px !important;" >Amount</th>
					<th class="header my-table-paddingTopBottom" style="width:7%;padding-top:5px !important;padding-bottom:5px !important;">Action</th>
				</tr>
			</thead>
			<script type="text/ng-template" id="customTemplate.html">
				<a ng-if="match.label != null && match.label != ''">
					<span ng-bind-html="match.label | typeaheadHighlight:query"></span> 
					<span ng-if="match.model.isColor || match.model.isSize || match.model.isVariant">
						(<span ng-if="match.model.isColor">{{match.model.color}} </span> <span ng-if="match.model.isSize">{{match.model.size}} </span> <span ng-if="match.model.isVariant">{{match.model.variant}}</span>)
					</span>
				</a>
			</script>
			<tbody portlet="" >
				<tr id="panelPortlet{{$index+1}}" ng-repeat="item in form.AccBillTable track by $index" class="myTable" data-ng-class="app.tableAnimation">
					<td style="text-align:center" class="portlet-handler">
						<strong ng-bind="$index+1"></strong>
					</td>
					<td>
						<div class="input-group mytypeDrop">
							<input typeahead="item[displayProductName] for item in getfilterProductDataForSuggestion() | filter:$viewValue | limitTo:10" ng-model="item.productName" typeahead-on-select="setProductData($item,$index);calculateTaxReverse(item,item.cgstPercentage,item.sgstPercentage,item.igstPercentage,$index);purchaseBill.advance = ((totalTable) + (purchaseBill.extraCharge ? purchaseBill.extraCharge*1 : 0) | setDecimal: noOfDecimalPoints);editProductSuggest = true;" autocomplete="off" type="text" class="form-control input-sm productNameClass" placeholder="*Enter Product Name"  typeahead-editable="false" ng-required="true" style="padding-left: 6px;padding-right: 6px;" typeahead-template-url="customTemplate.html" ng-disabled="form.loadData" ng-keypress="presssuburb($event)" />
							<span class="input-group-btn">
								 <button type="button" class="btn btn-default btn-sm" ng-if="item.productId" ng-click="editProductWithRedirect($index)"><i class="fa fa-edit" style="font-size:15px;color:#17A1E5;"></i></button>
							   <button type="button" class="btn btn-default btn-sm" data-ng-click="openProduct('lg',$index)"><i class="fa fa-plus" style="font-size:15px;color:#17A1E5;"></i></button>
							   <button ng-if="enableItemizedPurchaseSales && item.productId" type="button" class="btn btn-default btn-sm" tooltip="IMEI/Serial No"  tooltip-trigger="mouseenter" tooltip-placement="top" data-ng-click="openBarcodeModal('lg',$index)"><i class="fa fa-barcode" style="font-size:15px;color:#17A1E5;"></i></button>
							</span>
						</div>
						<ul class="itemize-expand-tree" ng-if="item.itemizeDetail.length > 0">
					 		<li ng-click="expandItemizeTree($index+1)"><i class="fa {{itemizeTreeIcon($index+1)}} fa-lg"></i> IMEI Info
					 			<ul class="{{openedItemizeTreeClass($index+1)}}">
					 				<li ng-repeat="itemize in item.itemizeDetail" class="clearfix">
							 			<span>{{itemize.qty}}x&nbsp;&nbsp;{{itemize.imei_no}}</span>
							 		</li>
					 			</ul>
					 		</li>
					 	</ul>
					</td>
					<td>
						<h6>{{form.productHsn[$index]}}</h6>
					</td>
					<td ng-if="divAdvanceMou">
						<select  ng-model="item.measurementUnit" data-ng-options="s.unitName for s in form.measurementUnitDrop[$index] track by ($index+s.measurementUnitId+s.unitName)" class="form-control input-sm" style="padding-left: 3px;padding-right: 3px;float:left;" ng-change="changeProductTable();changeQuantity($index);" >
						</select>
					</td>
					<td ng-if="enableDisableLWHSetting" class="header" style="text-align:center;">
						<input ng-if="enableDisableLWHArray[$index].lengthStatus" ng-required="true" ng-minlength="1" ng-pattern="/^(0*[1-9][0-9]*([\.][0-9]+)?|0+[\.][0-9]*[1-9][0-9]*)$/" ng-model="item.lengthValue" placeholder="Length" ng-change="changeProductTable();changeQuantity($index);" ng-style="enableDisableLWHArray[$index].styleObj" type="text" class="form-control input-sm" only-number/>
						<input ng-if="enableDisableLWHArray[$index].widthStatus" ng-required="true" ng-minlength="1" ng-pattern="/^(0*[1-9][0-9]*([\.][0-9]+)?|0+[\.][0-9]*[1-9][0-9]*)$/" ng-model="item.widthValue" ng-change="changeProductTable();changeQuantity($index);" ng-style="enableDisableLWHArray[$index].styleObj" type="text" class="form-control input-sm" placeholder="Width" only-number/>
						<input ng-if="enableDisableLWHArray[$index].heightStatus" ng-required="true" ng-minlength="1" ng-pattern="/^(0*[1-9][0-9]*([\.][0-9]+)?|0+[\.][0-9]*[1-9][0-9]*)$/" ng-model="item.heightValue" ng-change="changeProductTable();changeQuantity($index);" ng-style="enableDisableLWHArray[$index].styleObj" type="text" class="form-control input-sm" placeholder="Height" only-number/>
						<span class="pull-right" ng-show="enableDisableLWHArray[$index].lengthStatus || enableDisableLWHArray[$index].heightStatus || enableDisableLWHArray[$index].widthStatus">{{item.totalFt}} Ft</span>
					</td>
					<td style="text-align:center;" ng-if="divTag">
						<input  ng-if="enableDisableColor" placeholder="Color" type="text" ng-model="item.color"  class="form-control input-sm " ng-class="ProductColorSizeVarDesign"  ng-change="changeProductTable()" /> 
						<input ng-if="enableDisableSize" placeholder="Size" type="text" ng-model="item.size"  class="form-control input-sm "
						ng-class="ProductColorSizeVarDesign"  ng-change="changeProductTable()"  />
						<input ng-if="enableDisableVariant" placeholder="Variant" type="text" ng-model="item.variant"  class="form-control input-sm "
						ng-class="ProductColorSizeVarDesign"  ng-change="changeProductTable()"  />
					</td>
					<td ng-if="enableDisableFrameNo">
						<input placeholder="Frame No"  type="text" ng-model="item.frameNo"  class="form-control input-sm" style="width:100%;padding-left: 6px;padding-right: 6px;"   ng-pattern="/^[a-z-A-Z0-9 ]*$/" ng-change="changeProductTable()" /> 
					</td>
					<td>
						<input  type="text" ng-model="item.qty"  class="form-control input-sm" style="width:100%;padding-left: 6px;padding-right: 6px;"  ng-required="true" ng-minlength="1" ng-pattern="/^\s*(?=.*[1-9])\d*(?:\.\d{1,2})?\s*$/" ng-change="changeProductTable();calculateTaxReverse(item,item.cgstPercentage,item.sgstPercentage,item.igstPercentage,$index)" only-number /> 
					</td>
					<td>
						<!--span style="float:right">{{item.price}}</span-->
						<input placeholder="(&#x20b9;)Rate" id="price" type="text" ng-model="item.price"  class="form-control input-sm" style="width:100%;padding-left: 6px;padding-right: 6px;"  ng-required="true" ng-minlength="1" ng-pattern="/^\s*(?=.*[1-9])\d*(?:\.\d{1,2})?\s*$/" ng-change="changeProductTable();calculateTaxReverse(item,item.cgstPercentage,item.sgstPercentage,item.igstPercentage,$index)" only-number /> 
					</td>
					<td>
						<select  ng-model="item.discountType"  class="form-control input-sm" style="padding-left: 3px;padding-right: 3px;width:60%;float:left;" ng-change="changeProductTable();" >
							<option value="flat" selected="selected">Flat</option>
							<option value="percentage">%</option>
						</select>
						<input  type="text" ng-model="item.discount"  class="form-control input-sm" style="padding-left: 5px;padding-right: 5px;width:40%;" ng-pattern="/^[0-9 .]*$/" ng-change="changeProductTable();calculateTaxReverse(item,item.cgstPercentage,item.sgstPercentage,item.igstPercentage,$index)"  ng-attr-max="{{item.discountType == 'percentage' && '100' || ''}}" only-number /> 
					</td>
					<td style="text-align:right">
						<input id="price" type="text" ng-model="item.cgstPercentage"  class="form-control input-sm" placeholder="%" style="width:100%;padding-left: 6px;padding-right: 6px;height:10%"  ng-minlength="1" ng-pattern="/^[0-9]+[0-9 .]*$/" ng-change="changeProductTable();calculateTaxReverse(item,item.cgstPercentage,item.sgstPercentage,item.igstPercentage,$index);zeroSingleGst()" only-number ng-disabled="csgstDisable" /> 
						<span ng-if="item.cgstAmount > 0" > {{item.cgstAmount}} </span>
						<span title="Per Single Quantity" class="pull-left" ng-if="item.cgstAmount > 0" >({{item.cgstAmount/item.qty | setDecimal: noOfDecimalPoints}}/psq)</span>
					</td>
					<td style="text-align:right">
						<input id="price" type="text" ng-model="item.sgstPercentage"  class="form-control input-sm" placeholder="%" style="width:100%;padding-left: 6px;padding-right: 6px;height:10%"  ng-minlength="1" ng-pattern="/^[0-9]+[0-9 .]*$/" ng-change="changeProductTable();calculateTaxReverse(item,item.cgstPercentage,item.sgstPercentage,item.igstPercentage,$index);zeroSingleGst()" only-number ng-disabled="csgstDisable" /> 
						<span ng-if="item.sgstAmount > 0" >{{item.sgstAmount}}</span>
						<span title="Per Single Quantity" class="pull-left" ng-if="item.sgstAmount > 0" >({{item.sgstAmount/item.qty | setDecimal: noOfDecimalPoints}}/psq)</span>
					</td>
					<td style="text-align:right">
						<input id="price" type="text" ng-model="item.igstPercentage"  class="form-control input-sm" placeholder="%" style="width:100%;padding-left: 6px;padding-right: 6px;height:10%" ng-minlength="1" ng-pattern="/^[0-9]+[0-9 .]*$/" ng-change="changeProductTable();calculateTaxReverse(item,item.cgstPercentage,item.sgstPercentage,item.igstPercentage,$index);zeroSingleGst()" only-number ng-disabled="igstDisable" /> 
						<span ng-if="item.igstAmount > 0" >{{item.igstAmount}}</span>
						<span title="Per Single Quantity" class="pull-left" ng-if="item.igstAmount > 0" >({{item.igstAmount/item.qty | setDecimal: noOfDecimalPoints}}/psq)</span>
					</td>
					<td>
						<input placeholder="(&#x20b9;)Amount"  type="text" ng-model="item.amount"  class="form-control input-sm" style="width:100%;padding-left: 6px;padding-right: 6px;"  ng-required="true" ng-minlength="1" ng-pattern="/^[0-9]+[0-9 .]*$/" ng-change="changeProductTable();calculateTaxReverseTwo(item,item.cgstPercentage,item.sgstPercentage,item.igstPercentage,$index);" only-number />
					</td>
					<td style="">
					<center>
						<a href="javascript:void(0)" ng-click="addRow($index)">
							<i  class="fa fa-plus myCursorPointer" style="font-size:20px;"  ></i>
						</a>
						&nbsp;
						<a  class="text-danger" href="javascript:void(0)" ng-click="removeRow($index)" ng-if="$index!=0">
							<i  class="fa fa-times myCursorPointer" style="font-size:20px;" title="Delete"> </i>
						</a>
					</center>
					</td>
				</tr>
				<tr>
					<td colspan="{{totalTd}}"></td>
				</tr>
			</tbody>
			<tfoot>
				<tr>
					<td style="text-align:right" title="Total Quantity" colspan="{{colspanValue}}" >
						<strong ng-bind="getTotalQuantity()"><strong>
					</td>
					<td></td>
					<td> 
						<select  ng-model="purchaseBill.overallDiscountType"  class="form-control input-sm" style="padding-left: 3px;padding-right: 3px;width:60%;float:left;" ng-change="changeProductTable();advanceValueUpdate()" >
							<option value="flat" selected="selected">Flat</option>
							<option value="percentage">%</option>
						</select>
						<input  type="text" ng-model="purchaseBill.overallDiscount"  class="form-control input-sm" style="padding-left: 5px;padding-right: 5px;width:40%;" ng-pattern="/^[0-9 .]*$/" ng-change="changeProductTable();advanceValueUpdate()"  ng-attr-max="{{purchaseBill.overallDiscountType == 'percentage' && '100' || ''}}" only-number /> 
					</td>
					<td style="text-align:right">
						<input id="price" type="text" ng-disabled="totalCSgstDisable" ng-model="purchaseBill.totalCgstPercentage"  class="form-control input-sm" placeholder="%" style="width:100%;padding-left: 6px;padding-right: 6px;height:10%"  ng-minlength="1" ng-pattern="/^[0-9]+[0-9 .]*$/" ng-change="changeProductTable();zeroGstApply();advanceValueUpdate()" only-number /> 
						<span ng-if="purchaseBill.totalCgstAmount > 0 && !totalCSgstDisable" ng-disabled="totalCSgstDisable" ng-bind="purchaseBill.totalCgstAmount"></span>
					</td>
					<td style="text-align:right">
						<input id="price" type="text" ng-disabled="totalCSgstDisable" ng-model="purchaseBill.totalSgstPercentage"  class="form-control input-sm" placeholder="%" style="width:100%;padding-left: 6px;padding-right: 6px;height:10%"  ng-minlength="1" ng-pattern="/^[0-9]+[0-9 .]*$/" ng-change="changeProductTable();zeroGstApply();advanceValueUpdate()" only-number /> 
						<span ng-if="purchaseBill.totalSgstAmount > 0 && !totalCSgstDisable" ng-disabled="totalCSgstDisable" ng-bind="purchaseBill.totalSgstAmount" ></span>
					</td>
					<td style="text-align:right">
						<input id="price" type="text" ng-disabled="totalIgstDisable" ng-model="purchaseBill.totalIgstPercentage"  class="form-control input-sm" placeholder="%" style="width:100%;padding-left: 6px;padding-right: 6px;height:10%" ng-minlength="1" ng-pattern="/^[0-9]+[0-9 .]*$/" ng-change="changeProductTable();zeroGstApply();advanceValueUpdate()" only-number /> 
						<span ng-if="purchaseBill.totalIgstAmount > 0" ng-disabled="totalIgstDisable" ng-bind="purchaseBill.totalIgstAmount"></span>
					</td>
					<td ></td>
					<td colspan="1"></td>
				</tr> 
				
				<tr>
					<td style="text-align:right" title="Extra Charge" colspan="{{colspanValue}}" ><span style="visibility:hidden">{{totalRoundValue = (getTotal() | number: 0)}}</span><strong>E.Charge<strong></td>
					<td ng-init="purchaseBill.extraCharge = 0">
						<input placeholder="(&#x20b9;)Extra Charge" type="text" name="extraCharge" ng-model="purchaseBill.extraCharge"  class="form-control input-sm"   ng-pattern="/^[0-9 .]*$/" ng-change="changeProductTable();advanceValueUpdate()" style="padding-left: 6px;padding-right: 6px;" only-number /> 
						<span ng-messages="formBill.extraCharge.$error" ng-if="formBill.extraCharge.$dirty || formBill.extraCharge.$touched"  role="alert">
							<span ng-messages-include="errorPatternNumber"></span>
						</span>
					</td>
					<td></td>
					<!-- <td> 
						<select  ng-model="purchaseBill.overallDiscountType"  class="form-control input-sm" style="padding-left: 3px;padding-right: 3px;width:60%;float:left;" ng-change="changeProductTable();advanceValueUpdate()" >
							<option value="flat" selected="selected">Flat</option>
							<option value="percentage">%</option>
						</select>
						<input  type="text" ng-model="purchaseBill.overallDiscount"  class="form-control input-sm" style="padding-left: 5px;padding-right: 5px;width:40%;" ng-pattern="/^[0-9 .]*$/" ng-change="changeProductTable();advanceValueUpdate()"  ng-attr-max="{{purchaseBill.overallDiscountType == 'percentage' && '100' || ''}}" only-number /> 
					</td> -->
					<td colspan="3" style="text-align:right" >{{purchaseBill.tax = getTotalTax() ? (getTotalTax() | setDecimal: noOfDecimalPoints) : 0}}</td>
					<td style="text-align:right" ng-bind="totalTable_without_expense = getTotal() ? (getTotal() | setDecimal: noOfDecimalPoints) : 0;(openExpenseRawData ? totalTable_without_expense : totalTable = totalTable_without_expense)"></td>
					<!--td style="text-align:right"><span style="visibility:hidden">{{grandTotalTable = ((totalTable -- purchaseBill.tax) + (purchaseBill.extraCharge ? purchaseBill.extraCharge*1 : 0) | setDecimal: noOfDecimalPoints)}}<span></td-->
					<!-- <td style="text-align:right"><span style="visibility:hidden">{{grandTotalTable = (totalTable | setDecimal: noOfDecimalPoints)}}<span>
					</td> -->
					<td colspan="1">
						<button type="button" class="btn btn-sm" data-ng-class="app.theme.brand"  ng-click="openExpenseRaw()">Expense</button>
					</td>
				</tr> 
				<tr  ng-repeat="item in form.AccExpense track by $index" ng-if="openExpenseRawData">

					<td colspan="{{colspanExpenseValue}}">
						<!-- <span style="width: 30%;float: right;">
							<select chosen="" data-ng-model="item.expenseId" data-ng-options="s.expenseId as s.expenseName for s in expenseData track by s.expenseId" ng-change="ChangeExpense('expenseId',expenseData.expenseId)" class="form-control input-sm chosen-select" ></select>
						</span> -->

						<div class="input-group mytypeDrop" style="width: 30%;float: right;">
							<select  ng-model="item.expenseOperation"  class="form-control input-sm" style="width:25%;float:right;" ng-required="true">
								<option value="plus" selected="selected">+</option>
								<option value="minus">-</option>
					    	</select>
							<input typeahead="item.expenseName for item in expenseData | filter:$viewValue | limitTo:10" ng-model="item.expenseName" typeahead-on-select="setExpenseData($item,$index);" type="text" class="form-control input-sm" autocomplete="off" placeholder="*Enter Expense Name"  typeahead-editable="false" ng-required="true" style="float:right;padding-left: 5px;width:75%;" ng-disabled="form.loadData"/>	
							<!-- <span class="input-group-btn">
								 <button type="button" class="btn btn-default btn-sm" ng-if="item.productId" ng-click="editProductWithRedirect($index)"><i class="fa fa-edit fa-lg" style="color:#17A1E5;"></i></button>
							   <button type="button" class="btn btn-default btn-sm" data-ng-click="openProduct('lg',$index)"><i class="fa fa-plus fa-lg" style="color:#17A1E5;"></i></button>
							</span> -->
						</div>
						<label class="control-label" style="width: 30%;float: right;padding-right: 5px;"> Expense Name </label>

					</td>
					
					<td colspan="1" style="text-align:right;">
						<select  ng-model="item.expenseType"  class="form-control input-sm" style="padding-left: 3px;padding-right: 3px;width:60%;float:left;" ng-change="changeProductTable();advanceValueUpdate();" >
							<option value="flat" selected="selected">Flat</option>
							<option value="percentage">%</option>
						</select>
						<input  type="text" ng-model="item.expenseValue"  class="form-control input-sm" style="padding-left: 5px;padding-right: 5px;width:40%;" ng-pattern="/^[0-9 .]*$/" ng-change="changeProductTable();advanceValueUpdate();"  only-number /> 
					</td>
					<td colspan="3">
						<input type="text" placeholder="GST(%)" ng-model="item.expenseTax" class="form-control input-sm pull-left"  style="padding-left: 5px;padding-right: 5px;width:40%;" only-number>
						<span class="pull-right" ng-bind='(item.expenseTax * item.expenseValue / 100) | setDecimal: noOfDecimalPoints'></span>
					</td>
					<td colspan="1" style="text-align:right">
						<span ng-bind='expenseAmount[$index] = getExpenseValue($index) | setDecimal: noOfDecimalPoints'></span>
					</td>
					<td colspan="1">
						<center>
							<a href="javascript:void(0)" ng-click="addExpenseRow($index)"> 
								<i  class="fa fa-plus myCursorPointer" style="font-size:20px;"   ></i>
							</a>
							&nbsp;
							<a href="javascript:void(0)" class="text-danger"  ng-click="removeExpenseRow($index)">
								<i  class="fa fa-times myCursorPointer" style="font-size:20px;" title="Delete"> </i>
							</a>
						</center>
					</td>
				</tr>
				<tr >
					<td style="text-align:left;" colspan="2" > 
						<span style="width: 30%;float: left;"><strong> Due Date</strong></span>
						<div class="input-group hackyhack" >
							<input type="text" datepicker-popup="{{form.format}}"  data-ng-model="form.dueDate" is-open="form.openedStartServiceDate" min-date="false" max-date="false" datepicker-options="form.dateOptions2" date-disabled="form.disabled(form.data, form.mode)"  close-text="Close" class="form-control input-sm"  tooltip="Due date" tooltip-trigger="focus" tooltip-placement="top" ng-required="true" readonly ng-change="dueDateChange()"/>
							<span class="input-group-btn" >
							   <button type="button" data-ng-click="form.openStartServiceDate($event)" id="serviceDatepickerButton"  class="btn btn-sm" data-ng-class="app.theme.brand">
								  <em class="fa fa-calendar"></em>
							   </button>
							</span>
						</div>

					</td>
					<td style="text-align:right" colspan="{{colspanAdvanceValue}}" > <strong> Advance </strong> </td>
					<td colspan="2" > 
						<input placeholder="(&#x20b9;)Advance" type="text" name="advance"  ng-model="purchaseBill.advance"  class="form-control input-sm"   ng-pattern="/^[0-9]+[0-9 .]*$/" ng-change="changeProductTable()" style="height:30px;padding-left: 6px;padding-right: 6px;padding-bottom: 8px;padding-top: 8px;" only-number /> 
						<span ng-messages="formBill.advance.$error" ng-if="formBill.advance.$dirty || formBill.advance.$touched"  role="alert">
							<span ng-messages-include="errorPatternNumber"></span>
						</span>
					</td>
					<td style="text-align:left"> <strong> Balance </strong></td>
					<td style="text-align:right" >{{purchaseBill.balanceTable = ((openExpenseRawData ? totalTable : totalTable_without_expense) - (purchaseBill.advance ? purchaseBill.advance*1 : 0) | setDecimal: noOfDecimalPoints)}}</td>
				</tr>
			</tfoot>
		</table>
	</div>
	
		<div class="panel-body">
			
			<div class="col-sm-12" >
				<div class="col-sm-3">
					<fieldset class="my-fieldset-paddingBottom my-fieldset-marginBottom">
					   <div class="form-group">
						  <label class="col-sm-3 control-label"> *P.Mode </label>
							<div class="col-sm-9">
								<select chosen="" data-ng-model="purchaseBill.paymentMode" data-ng-options="s for s in form.paymentModeDrop" class="form-control input-sm chosen-select" ng-required="true" ng-change="changePaymentInBill('paymentMode',purchaseBill.paymentMode);changeProductTable();" >
								<option value=""></option>
								</select>
							</div>
					   </div>
					</fieldset>
				</div>
				<div class="col-sm-3">
					
					<fieldset class="my-fieldset-paddingBottom my-fieldset-marginBottom">
						<div class="form-group">
							<label  class="col-sm-4 control-label">Remark</label>
							<div class="col-sm-8">
								<textarea rows="1" ng-model="purchaseBill.remark" name="address"  placeholder="Remark" class="form-control input-sm ng-pristine ng-valid ng-touched" ng-change="changeInBill('remark',purchaseBill.remark)" style="height:38px;" ></textarea>
							</div>
						</div>
					</fieldset>
				</div>
				<div class="col-sm-4">
					<fieldset class="my-fieldset-paddingBottom my-fieldset-marginBottom">
						<!--div class="form-group">
							<label  class="col-sm-3 control-label">Attachment</label>
							<div class="col-sm-6">
								<input type="file" class="filestyle" data-btnClass="btn-default"  onchange="angular.element(this).scope().uploadFile(this.files)" multiple />
							</div>
						</div-->
						<div class="input-group">
						  <span class="input-group-btn" >
							<button type="button" class="btn btn-sm" data-ng-class="app.theme.brand" onclick="angular.element(this).parent().find('input[type=file]').click();">Attachments</button>
							<input style="display: none;" type="file" name="uploaded_file" onchange="angular.element(this).parent().parent().find('.form-control').html(this.files.length > 1 ? this.files.length+' files' : this.files[0].name);angular.element(this).scope().uploadFile(this.files);"  multiple>
						  </span>
						  <span class="form-control input-sm fileAttachLabel" style="width: 117%;" ></span>
						</div>
					</fieldset>
					
				</div>
			</div>
			
			<div class="col-sm-12" ng-if="purchaseBill.paymentMode=='bank' || purchaseBill.paymentMode=='card'" data-ng-class="app.tableAnimation">
				<div class="col-sm-4">
					<fieldset class="my-fieldset-paddingBottom my-fieldset-marginBottom">
					   <div class="form-group">
						  <label  class="col-sm-2 control-label">*Bank</label>
							<div class="col-sm-10">
								<select chosen="" data-ng-model="purchaseBill.BankName" data-ng-options="s for s in form.bankDrop | orderBy:bankName" class="form-control input-sm chosen-select" size="5" ng-required="true" ng-change="changeInBill('bankName',purchaseBill.BankName)"></select>
							</div>
					   </div>
					</fieldset>
				</div>
				<div class="col-sm-4">
					<fieldset class="my-fieldset-paddingBottom my-fieldset-marginBottom" >
						<div class="form-group">
						  <label  class="col-sm-3 control-label">*cheque#</label>
						  <div class="col-sm-8">
							 <input ng-model="purchaseBill.chequeNo" name="chequeNo"  type="text" placeholder="cheque Number" class="form-control input-sm" ng-pattern="/^[0-9]*$/" ng-required="true" ng-change="changeInBill('checkNumber',purchaseBill.chequeNo)" only-number />
							 <span ng-messages="formBill.chequeNo.$error" ng-if="formBill.chequeNo.$dirty || formBill.chequeNo.$touched"  role="alert">
								<span ng-messages-include="errorPatternNumber"></span>
							</span>
						  </div>
					   </div>
					</fieldset>
				</div>
				<div class="col-sm-4">
					<fieldset class="my-fieldset-paddingBottom my-fieldset-marginBottom">
					   <div class="form-group">
						  <label  class="col-sm-2 control-label">*Our Bank</label>
							<div class="col-sm-10">
								<select chosen="" data-ng-model="purchaseBill.bankLedgerId" data-ng-options="s.ledgerName for s in form.bankLedgerDrop" class="form-control input-sm chosen-select" size="5" ng-required="true" ng-change="changeInBill('bankLedgerId',purchaseBill.bankLedgerId.ledgerId)"></select>
							</div>
					   </div>
					</fieldset>
				</div>
			</div>
			
		<div class="col-sm-12">
			<div class="col-sm-6">
				<button type="button" class="mr-sm mb-sm btn btn-sm pull-left" data-ng-class="app.theme.brand" ng-click="pop('not')" ng-disabled="formBill.$invalid || disableButton"  > <span ng-if="purchaseBill.EditBillData">Update</span> <span ng-if="!purchaseBill.EditBillData">Save</span> </button>
				
				<button type="button" class="mr-sm mb-sm btn btn-sm pull-left" data-ng-class="app.theme.brand"  ng-click="cancel()"   >New</button>
				
				<button type="button" class="mr-sm mb-sm btn btn-sm pull-left" data-ng-class="app.theme.brand" ng-click="deleteBill('sm')" ng-if="purchaseBill.EditBillData"  >Delete</button>
				
				<button type="button" class="mr-sm mb-sm btn btn-sm pull-left"  data-ng-class="app.theme.brand" ng-if="purchaseBill.EditBillData"  ng-click="cancel('copy')"  >Copy</button>
			</div>
			
			<div class="col-sm-6" >
				 <button type="button" class="mr-sm mb-sm btn btn-sm" data-ng-class="app.theme.brand" ng-click="DWT_AcquireImage();"  >Scan ({{countScannedDocumet}})</button>
				 
				<button type="button" class="mr-sm mb-sm btn btn-sm" ng-click="goToNextPrevious('first')"  data-ng-class="app.theme.brand"    > First </button>
				
				<button type="button" class="mr-sm mb-sm btn btn-labeled btn-sm"  ng-click="goToNextPrevious('previous')" data-ng-class="app.theme.brand"   >
				   <span class="btn-label"><i class="fa fa-arrow-left"></i>
				   </span>Previous</button>
				   
				<button type="button" class="mr-sm mb-sm btn btn-labeled btn-sm"   ng-click="goToNextPrevious('next')" ng-disabled="!purchaseBill.EditBillData" data-ng-class="app.theme.brand"  >Next
					<span class="btn-label btn-label-right"><i class="fa fa-arrow-right"></i>
					</span>
				</button>
				
				<button type="button" class="mr-sm mb-sm btn btn-sm" ng-click="goToNextPrevious('last')"  data-ng-class="app.theme.brand"   > Last </button>
			</div>
		</div>

		<div class="col-sm-12 mt-lg" >
			<a href="javascript:void(0)" ng-click="openInNextTab(erpPath+item.documentUrl+item.documentName)"  ng-repeat="item in purchaseBill.documentData track by item.documentId"  class="imageAncher" ng-if="item.documentFormat != 'pdf'" data-ng-class="app.tableAnimation" >
				<i class="fa fa-window-close myCrossDesign" data-ng-class="app.tableAnimation" ng-click="documentDelete(item);$event.stopPropagation();"  ng-if="!item.ShowConfirm" ></i>
				<i class="fa fa-check documentRight" data-ng-class="app.tableAnimation" ng-click="documentDeleteConfirm(item,$index);$event.stopPropagation()" ng-if="item.ShowConfirm" ></i>
				<i class="fa fa-times documentCross" data-ng-class="app.tableAnimation" ng-click="documentDelete(item);$event.stopPropagation();" ng-if="item.ShowConfirm" ></i>
				<img ng-src="{{erpPath}}{{item.documentUrl}}{{item.documentName}}" alt="" height="130" width="150" class="img-thumbnail img-responsive" />
			</a>
		</div>


      </div>
	</div>
	</form>	
</div>
<div   style="display:none" >
	<div id="dwtcontrolContainer" style="display:block"></div>
</div>
<script type="text/ng-template" id="errorRequired">
	<span class="text-danger" ng-message="required">{{errorMessage.require}}</span>
</script>
<script type="text/ng-template" id="errorLonglength">
	<span class="text-danger" ng-message="maxlength">{{errorMessage.longLength}}</span>
</script>
<script type="text/ng-template" id="errorShortlength">
	<span class="text-danger" ng-message="minlength">{{errorMessage.shortLength}}</span>
</script>
<script type="text/ng-template" id="errorEmail">
	<span class="text-danger" ng-message="pattern">{{errorMessage.email}}</span>
</script>
<script type="text/ng-template" id="errorPatternAlpha">
	<span class="text-danger" ng-message="pattern">{{errorMessage.Alphabets}}</span>
</script>
<script type="text/ng-template" id="errorPatternNumber">
	<span class="text-danger" ng-message="pattern">{{errorMessage.Numbers}}</span>
</script>
<script type="text/ng-template" id="errorPatternNumberContact">
	<span class="text-danger" ng-message="pattern">Only Number & Not Start With Zero</span>
</script>
<script type="text/ng-template" id="errorPatternAlphaNumeric">
	<span class="text-danger" ng-message="pattern">{{errorMessage.AlphaNumeric}}</span>
</script>
<script type="text/ng-template" id="errorPatternThisSpecial">
	<span class="text-danger" ng-message="pattern">{{errorMessage.thisSpecialCharacter}}</span>
</script>